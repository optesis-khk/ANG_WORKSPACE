<odoo>
  <data>

    <record model="ir.ui.view" id="optesis_asset_tree">
      <field name="priority" eval="15"/>
      <field name="name">optesis.asset.tree</field>
      <field name="model">optesis.asset.asset</field>
      <field name="arch" type="xml">
        <tree string="asset_list">
          <field name="product_id"/>
          <field name="family_id"/>
          <field name="code_bar"/>
          <field name="condition" />
          <field name="brand"/>
          <field name="site" />
          <field name="room"/>
          <field name="direction"/>
          <field name="department"/>
          <field name="service"/>
          <field name="inventory_date"/>
          <field name="last"/>
          <field name="date_service"/>
          <field name="value"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="optesis_asset_transient_tree">
      <field name="priority" eval="15"/>
      <field name="name">optesis.asset.transient.tree</field>
      <field name="model">optesis.asset.asset.transient</field>
      <field name="arch" type="xml">
        <tree string="asset_list">
          <field name="product_id"/>
          <field name="family_id"/>
          <field name="code_bar"/>
          <field name="condition" />
          <field name="brand"/>
          <field name="site" />
          <field name="room"/>
          <field name="direction"/>
          <field name="department"/>
          <field name="service"/>
          <field name="inventory_date"/>
          <field name="last"/>
          <field name="date_service"/>
          <field name="value"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="optesis_asset_form">
      <field name="priority" eval="15"/>
      <field name="name">optesis.asset.form</field>
      <field name="model">optesis.asset.asset</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <group>
                <div class="oe_title">
                  <label for="code_bar" class="oe_edit_only"/> <br/>
                  <h1 onkeyup="test_key(event)" type="object" name="asset_renew" id="code"> <field name="code_bar" class="oe_inline bar" default_focus="1" required="True"/>  </h1>

                  <script>
                    var i = 0;
                    function test_key(event){
                    var but = document.getElementById("asset_renew");

                    if (event.keyCode == 45 || event.keyCode == 13 ){
                    this.write;
                    jQuery('footer button:last').click();
                    //$("#code").click();
                    i = i+1;
                    console.log(window.location.href);
                    //console.log(window.form.length);
                    //ass = new odoo.web.Model('optesis.asset.asset');
                    //ass.create;
                    }
                    }
                  </script>

                </div>

              </group>
              <group>
                <div class="oe_title">
                  <label for="product_id" class="oe_edit_only"/> <br/>
                  <h1> <field name="product_id" class="oe_inline" required="True"/> </h1>
                </div>
              </group>
            </group>
            <group>
              <group>
                <field name="service" required="True" />
                <field name="department" required="True"/>
                <field name="direction" required="True"/>
                <field name="agents" domain="[('service', '=', service)]"/>
              </group>

              <group>
                <field name="site" required="True"/>
                <field name="building"  domain="[('site_id', '=', site)]" required="True"/>
                <field name="level"  domain="[('building_id', '=', building)]" required="True"/>
                <field name="room"  domain="[('level_id', '=', level)]" required="True"/>
              </group>
            </group>

            <group>
              <group>
                <field name="condition" required="True"/>
                <field name="brand"/>
                <field name="specifications"/>
                <field name="value"/>
              </group>
              <group>
                <field name="family_id" required="True"/>
                <field name="inventory_date"/>
                <field name="last"  invisible='1'/>
                <field name="asset_number"/>
                <field name="date_service"/>
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
              </group>

            </group>
            <notebook>
              <page string="Historique">
                <field name="log_ids" readonly="1">
                  <tree>
                    <field name="date"/>
                    <field name="description"/>
                  </tree>
                </field>
              </page>
            </notebook>
            <footer>
              <button  type="object" string="Save and new" name="asset_renew" class="oe_highlight pull-right" />
              <!-- <button name="action_save" type="object" string="Save and close"/> -->
            </footer>
          </sheet>
        </form>
      </field>
    </record>

    <record id="optesis_asset_graph" model="ir.ui.view">
      <field name="name">optesis.asset.graph</field>
      <field name="model">optesis.asset.asset</field>
      <field name="arch" type="xml">
        <graph string="Analyse Graphique" type="pivot" stacked="True">
          <field name="product_id"/>
          <field name="family_id"/>
          <field name="code_bar"/>
          <field name="condition" />
          <field name="brand"/>
          <field name="site" />
          <field name="room"/>
          <field name="direction"/>
          <field name="department"/>
          <field name="service"/>
          <field name="inventory_date"/>
          <field name="last"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </graph>
      </field>
    </record>


    <record model="ir.ui.view" id="family_tree">
      <field name="name">optesis.family.tree</field>
      <field name="model">optesis.family</field>
      <field name="arch" type="xml">
        <tree string="Famille d'immobilisation">
          <field name="name"/>
          <field name="description"/>

        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="family_form">
      <field name="name">optesis.family.form</field>
      <field name="model">optesis.family</field>
      <field name="arch" type="xml">
        <form >
          <sheet string="Famille d'immobilisation">
            <group>
              <group>
                <field name="name"/>
                <field name="description"/>
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
              </group>
            </group>
          </sheet>

        </form>
      </field>
    </record>

    <record model="ir.ui.view" id="condition_tree">
      <field name="name">condition.tree</field>
      <field name="model">optesis.condition</field>
      <field name="arch" type="xml">
        <tree string="condition_list">
          <field name="name"/>
          <field name="description"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="condition_form">
      <field name="name">condition.form</field>
      <field name="model">optesis.condition</field>
      <field name="arch" type="xml">
        <form string="condition_form">
          <sheet>
            <group colspan="4">
              <group colspan="2" rowspan="2" string="Condition">
                <field name="name" />
                <field name="description" />
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record model="ir.ui.view" id="article_tree">
      <field name="name">article.tree</field>
      <field name="model">optesis.product</field>
      <field name="arch" type="xml">
        <tree string="article_list">
          <field name="name"/>
          <field name="description"/>
          <field name="category_id" />
          <field name="price"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="article_form">
      <field name="priority" eval="5" />
      <field name="name">article.form</field>
      <field name="model">optesis.product</field>
      <field name="arch" type="xml">
        <form string="article_form">
          <sheet string="Standard des Immobilisations">
            <group colspan="4">
              <group>
                <field name="name" />
                <field name="category_id"/>
              </group>
              <group>
                <field name="description" />
                <field name="price" />
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record model="ir.ui.view" id="asset_seacrh_view">
      <field name="priority" eval="1"/>
      <field name="name">optesis.asset.search</field>
      <field name="model">optesis.asset.asset</field>
      <field name="arch" type="xml">
        <search>
          <field name="product_id"/>
          <field name="code_bar"/>
          <field name="brand"/>
          <field name="family_id" />
          <field name="direction" />
          <field name="department"/>
          <field name="service"/>
          <field name="site" />
          <field name="building"/>
          <field name="level" />
          <field name="room" />
          <field name="value"/>
          <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
        </search>
      </field>
    </record>

    <record model="ir.ui.view" id="control_form">
      <field name="name">control.form</field>
      <field name="model">optesis.control</field>
      <field name="arch" type="xml">
        <form string="Controle des inventaires">
          <header>
            <button name="start_control" string="Commencer" type="object" class="oe_highlight" states="draft"/>
            <button name="validate_control" string="Valider" type="object" class="oe_highlight" states="open"/>
            <field name="state" widget="statusbar" statusbar_visible="draft,open,end"/>
          </header>
          <sheet>
            <group>
              <group>
                <field name="site_id" />
                <field name="level_id" domain="[('building_id', '=', building_id)]" required="True"/>
                <field name="service_id" required="True"/>
              </group>
              <group>
                <field name="building_id" domain="[('site_id', '=', site_id)]" required="True"/>
                <field name="room_id" domain="[('level_id', '=', level_id)]" required="True"/>
                <field name="condition_id"/>
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
              </group>
            </group>
            <div class="oe_title">
              <label for="code_barre" class="oe_edit_only"/> <br/>
              <h1 onkeyup="get_code(event)" type="object" name="change_code_barre">
                <field name="code_barre" class="oe_inline bar" placeholder="Recherche du code barre" default_focus="1" attrs="{'invisible':[('state', '!=', 'open')]}"/>  </h1>
                <script>
                  var i = 0;
                  function get_code(event){
                  if (event.keyCode == 45){
                  jQuery('footer button:last').click();

                  }
                  }
                </script>

              </div>
              <notebook>
                <page string="inventaire" attrs="{'invisible':[('state', '=', 'draft')]}">
                  <field name="asset_ids" attrs="{'readonly':[('state','=','end')]}">
                    <!-- <tree>
                    <field name="product_id"/>
                    <field name="family_id"/>
                    <field name="code_bar"/>
                    <field name="site"/>
                    <field name="building"/>
                    <field name="level"/>
                    <field name="room"/>
                    <field name="service"/>
                    <field name="condition"/>
                  </tree> -->
                </field>
              </page>
            </notebook>
            <footer>
              <button  type="object" string="verifier" name="change_code_barre" id="check" invisible="1"/>
            </footer>
          </sheet>
        </form>
      </field>
    </record>






    <act_window id="win001" name="Inventaire" res_model="optesis.asset.asset" view_mode="tree,form" />
    <menuitem id="asset_menu_0" name="Optimo" web_icon="optimo,static/description/icon.png" sequence="100"/>


    <menuitem id="asset_menu_1" name="Menu Général" parent="asset_menu_0" sequence="1"/>
    <menuitem id="asset_menu_5" name="Catalogues" parent="asset_menu_0" sequence="2"/>
    <menuitem id="asset_menu_3" name="Organisations" parent="asset_menu_0" sequence="3"/>
    <menuitem id="asset_menu_4" name="Localisations" parent="asset_menu_0" sequence="9"/>

    <menuitem id="asset_menu_2" name="Inventaire" parent="asset_menu_1" action="win001" sequence="2"/>

    <act_window id="win011" name="Familles" res_model="optesis.family" view_mode="tree,form"/>
    <menuitem id="category_menu_2" name="Familles" parent="asset_menu_5" action="win011" sequence="14"/>


    <act_window id="win014" name="Standards" res_model="optesis.product" view_mode="tree,form"/>
    <menuitem id="article_menu_2" name="Standards" parent="asset_menu_5" action="win014" sequence="17"/>

    <act_window id="win015" name="États" res_model="optesis.condition" view_mode="tree,form"/>
    <menuitem id="condition_menu_2" name="États" parent="asset_menu_5" action="win015" sequence="18"/>

    <act_window id="win_inv_100" name="Controle" res_model="optesis.control" view_mode="tree,form" />
    <menuitem id="asset_menu_controle" name="Controle inventaire" parent="asset_menu_1" action="win_inv_100" sequence="19"/>

    <act_window id="win_inv_101" name="Reporting" res_model="optesis.asset.asset" view_mode="pivot,graph" />
    <menuitem id="asset_menu_report" name="Reporting" parent="asset_menu_1" action="win_inv_101" sequence="201"/>

  </data>
</odoo>
